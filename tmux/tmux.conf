# https://github.com/samoshkin/tmux-config/blob/master/tmux/tmux.conf

# Terminal
set -g default-terminal "xterm-256color"

# Change prefix key to C-a, easier to type, same to "screen"
unbind C-a
set -g prefix C-a

# clear
unbind K
bind K send-keys -R \; send-keys C-l \; clear-history

# Set parent terminal title to reflect current window in tmux session 
set -g set-titles on
set -g set-titles-string "#I:#W"

# Start index of window/pane with 1
set -g base-index 1
setw -g pane-base-index 1

# Enable mouse support for switching panes/windows
# NOTE: This breaks selecting/copying text on OSX
# To select text as expected, hold Option to disable it (iTerm2)
set -g mouse on

# General status bar settings
set -g status on
set -g status-interval 2
set-option -g status-position top

# Reload tmux configuration 
bind r source-file ~/.config/tmux/tmux.conf\; display "Config reloaded"

# new window and retain cwd
bind c new-window -c "#{pane_current_path}"

# Rename session and window
unbind "\$" # rename-session
unbind ,    # rename-window
bind r command-prompt -I "#{window_name}" "rename-window '%%'"
bind R command-prompt -I "#{session_name}" "rename-session '%%'"

# Navigate panes
# NOTE "$HOME/.config/alacritty/alacritty.toml" bindings
# bind-key -n C-h select-pane -L
# bind-key -n C-j select-pane -D
# bind-key -n C-k select-pane -U
# bind-key -n C-l select-pane -R
# unbind C-h
# unbind C-j
# unbind C-k
# unbind C-l
# bind-key -n -r C-Left select-pane -L
# bind-key -n -r C-Down select-pane -D
# bind-key -n -r C-Up select-pane -U
# bind-key -n -r C-Right select-pane -R
 
# Navigate windows
bind -r Tab last-window   # cycle thru MRU tabs
unbind [    # paste-buffer
unbind ]
bind -r [ swap-window -t -1\; previous-window
bind -r ] swap-window -t +1\; next-window

# pane resize
# NOTE "$HOME/.config/alacritty/alacritty.toml" bindings
# bind-key -n -r M-h resize-pane -L
# bind-key -n -r M-j resize-pane -D
# bind-key -n -r M-k resize-pane -U
# bind-key -n -r M-l resize-pane -R
# bind-key -n -r M-Left resize-pane -L
# bind-key -n -r M-Down resize-pane -D
# bind-key -n -r M-Up resize-pane -U
# bind-key -n -r M-Right resize-pane -R

# Kill pane/window/session shortcuts
bind x kill-pane
bind X kill-window
bind C-x confirm-before -p "kill other windows? (y/n)" "kill-window -a"
bind Q confirm-before -p "kill-session #S? (y/n)" kill-session

# Split V and H
# NOTE "$HOME/.config/alacritty/alacritty.toml" bindings
# unbind %
# unbind '"'
# bind-key | split-window -h
# bind-key - split-window -v


# When scrolling with mouse wheel
bind -T copy-mode-vi WheelUpPane       select-pane \; send-keys -X -N 1 scroll-up
bind -T copy-mode-vi WheelDownPane     select-pane \; send-keys -X -N 1 scroll-down

# mouse wheel scroll in nano less more man git
# https://github.com/tmux/tmux/issues/1320#issuecomment-381952082
bind-key -T root WheelUpPane \
	if-shell -Ft= '#{?mouse_any_flag,1,#{pane_in_mode}}' \
		'send -Mt=' \
		'if-shell -t= "#{?alternate_on,true,false} || echo \"#{tmux_commands_with_legacy_scroll}\" | grep -q \"#{pane_current_command}\"" \
			"send -t= Up" "copy-mode -et="'

bind-key -T root WheelDownPane \
	if-shell -Ft = '#{?pane_in_mode,1,#{mouse_any_flag}}' \
		'send -Mt=' \
		'if-shell -t= "#{?alternate_on,true,false} || echo \"#{tmux_commands_with_legacy_scroll}\" | grep -q \"#{pane_current_command}\"" \
			"send -t= Down" "send -Mt="'

# List of plugins
# leader (C-b)+I
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'catppuccin/tmux'
set -g @plugin 'christoomey/vim-tmux-navigator'

set -g @catppuccin_window_left_separator ""
set -g @catppuccin_window_right_separator " "
set -g @catppuccin_window_middle_separator " █"
set -g @catppuccin_window_number_position "right"

set -g @catppuccin_window_default_fill "number"
set -g @catppuccin_window_default_text "#W"

set -g @catppuccin_window_current_fill "number"
set -g @catppuccin_window_current_text "#W"

set -g @catppuccin_status_modules_right "directory session"
set -g @catppuccin_status_left_separator  " "
set -g @catppuccin_status_right_separator ""
set -g @catppuccin_status_fill "icon"
set -g @catppuccin_status_connect_separator "no"

set -g @catppuccin_directory_text "#{pane_current_path}"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run "~/.config/tmux/plugins/tpm/tpm"
